# Скрипты для работы с Git

Этот каталог содержит скрипты для автоматизации работы с Git, включая проверку кода линтерами перед коммитом и пушем.

## Установка Git Hooks

Перед использованием системы проверки необходимо установить git hooks:

```bash
npm run install-hooks
```

или

```bash
bash scripts/install-hooks.sh
```

Этот скрипт копирует `pre-commit-hook` и `pre-push-hook` в `.git/hooks/` и делает их исполняемыми.

## Использование

### Автоматический коммит и пуш с проверкой

Для автоматического коммита и пуша изменений с проверкой линтерами используйте:

```bash
npm run push "сообщение коммита"
```

или

```bash
node scripts/push.js "сообщение коммита"
```

Этот скрипт:
1. Проверяет все измененные файлы линтерами (ESLint для JS/TS/Vue, Stylelint для CSS/SCSS)
2. Автоматически исправляет ошибки, которые можно исправить автоматически
3. Форматирует файлы с помощью Prettier
4. Добавляет все изменения в staging area
5. Создает коммит с указанным сообщением
6. Отправляет изменения в удаленный репозиторий (pre-push hook автоматически запустится)

### Автоматическая проверка при коммите

При выполнении `git commit` автоматически запустится `pre-commit` hook, который:

1. Проверит все staged файлы линтерами (ESLint для JS/TS/Vue, Stylelint для CSS/SCSS)
2. Проверит TypeScript файлы на ошибки компиляции через `nuxi typecheck`
3. Попытается автоматически исправить ошибки
4. Отформатирует файлы с помощью Prettier
5. Добавит исправленные файлы обратно в staging area
6. Отменит коммит, если остались неисправленные ошибки

### Ручной пуш с автоматической проверкой

Если вы уже создали коммит вручную, при выполнении `git push` автоматически запустится `pre-push` hook, который:

1. Проверит все измененные файлы (staged и unstaged) линтерами
2. Попытается автоматически исправить ошибки
3. Отменит пуш, если остались неисправленные ошибки

## Структура скриптов

- **`pre-commit-hook`** - Git hook, который запускается автоматически перед каждым `git commit`
  - Проверяет staged файлы линтерами (ESLint, Stylelint)
  - Проверяет TypeScript файлы на ошибки компиляции
  - Автоматически исправляет ошибки и форматирует код
- **`pre-push-hook`** - Git hook, который запускается автоматически перед каждым `git push`
  - Проверяет все измененные файлы (staged и unstaged) линтерами
  - Автоматически исправляет ошибки
- **`install-hooks.sh`** - Скрипт для установки git hooks
- **`push.js`** - Node.js скрипт для автоматического коммита и пуша с проверкой
- **`push.sh`** - Bash версия скрипта для автоматического коммита и пуша (альтернатива)

## Примечания

- Скрипты проверяют только файлы с расширениями: `.js`, `.ts`, `.vue`, `.css`, `.scss`
- Pre-commit hook проверяет только staged файлы (файлы, добавленные в staging area через `git add`)
- Pre-commit hook включает проверку TypeScript на ошибки компиляции через `nuxi typecheck`
- Pre-push hook проверяет как staged, так и unstaged файлы для максимальной безопасности
- Если автоматическое исправление не помогло, коммит или пуш будет отменен, и вам нужно будет исправить ошибки вручную
- Исправленные файлы автоматически добавляются обратно в staging area после исправления
- Проверка TypeScript может занять некоторое время, особенно при первом запуске
